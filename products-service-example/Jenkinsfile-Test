def stages() {

    stage("Init") {
        def comandossh = "ssh -i /var/jenkins_home/keyssh-devops-curso.pem ec2-user@JenkinsDockerTF sudo "
        def branchName = env.BRANCH_NAME
        def gitCredentials = "CREDENTIAL_ID"
        def repoUrl = "https://github.com/devopsort/products-service-example.git"
                                
        def qa = load ("/var/jenkins_home/workspace/products-service-example_Test/products-service-example/script.groovy")

	} 
    stage ("Checkout") {
        checkout scm

    }
    stage ("Build") {
		sh "ssh -i /var/jenkins_home/keyssh-devops-curso.pem ec2-user@JenkinsDockerTF sudo ' docker build --build-arg JAR_FILE=products-service-example.jar -t 127.0.0.1:5000/products-service:${env.BRANCH_NAME} ./ac1cicd-${env.BRANCH_NAME} '"

    }
    stage ("Test") {
		echo 'testing the application...'

    }
	stage('Deploy in Test env') {
		sh "${qa}.deployAppTEST()"

    }
}
return this