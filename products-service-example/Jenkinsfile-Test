def test

def stages() {

    stage("Init") {
		def comandossh = "ssh -i /var/jenkins_home/keyssh-devops-curso.pem ec2-user@JenkinsDockerTF sudo "
        def branchName = env.BRANCH_NAME
		def gitCredentials = "CREDENTIAL_ID"
		def repoUrl = "https://github.com/devopsort/products-service-example.git"
					
		def test = load "/var/jenkins_home/workspace/products-service-example_Test/products-service-example/script.groovy" 

        }   
		
    stage ("Checkout") {
        checkout scm
    }

    stage ("Build") {
		sh "$test.buildAppTEST()"
    }

    stage ("Test") {
		sh "$test.testApp()"
    }
	
	stage('Deploy in Test env') {
        when {
            branchName = "Test"
        }            
		steps {
			sh "$test.deployAppTEST()"
            }
        }
	}
return this